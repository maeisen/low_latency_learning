The reliability and robustness of wireless communication systems has become a key component in the design and implementation of large scale systems in the Internet-of-Things (IoT). For these systems to operate successfully, it is important that the data collected by sensors can be communicated throughout the IoT network. While the most reliable form of data communication is through wired connections, the scale and mobility of modern IoT settings has rendered the cost of installing and maintaining a wired network a significant challenge~\cite{wollschlaeger2017future}. Consequently, there is great interest in the design of wireless control systems that can achieve reliable performance~\cite{varghese2014wireless, li2017review}. Low-latency wireless transmissions are however a necessary feature in many wireless IoT systems, particularly those in industrial control~\cite{varghese2014wireless}.  The primary challenge is then the inherent trade-off that occurs between reliability and latency, as it is difficult to maintain high reliability while using higher data rates due to the stochasticity of the wireless channel. It is necessary to design resource allocation and scheduling protocols for wireless control systems that can both meet reliability \emph{and} latency requirements of the control system.


%In the wireless communications research and industry, many radio resource allocation schems in the form of wireless scheduling techniques have been proposed to provide reliability, or quality of service (QoS), to users across the network in the form of throughput, fairness and/or latency~\cite{cao2001scheduling,wongthavarawat2003packet,fattah2002overview,yaacoub2012survey}. For instance, round-robin scheduling is a common approach due to its simplicity inherent fairness. Algorithms such as proportional fair (PF)~\cite{kim2005proportional}, max-SNR~\cite{knopp1995information} and their variations have been designed for maximizing the overall system throughput and/or fairness. However, these algorithms can perform very poorly with regards to ensuring that all of the admitted users' packet delivery rates and latency targets will be met. For time-sensitive applications such as industrial control and automation, the experiences of individual users/devices are highly dependent on the ability of the network to deliver their packets within a latency bound. If this objective is not met, the high overall system throughput or throughput-fairness means little to the end users. On the other hand, the generic delay-aware schedulers such as EDF~\cite{wu2014analysis} and WFQ~\cite{lu1999fair} do not properly adapt to wireless channel conditions and may make poor radio resource allocation decisions. These algorithms have also been modified to adapt to wireless channel conditions, such as in M-LWDF \cite{andrews2001providing}. However, all such wireless scheduling algorithms are unable to leverage the information on the control system dynamics and thus, perform inefficiently when deployed in time-sensitive wireless control systems.

In the wireless communications research and industry, many radio resource allocation schemes in the form of wireless scheduling techniques have been proposed to provide reliability, or quality of service (QoS), to users across the network in the form of throughput, fairness and/or latency~\cite{cao2001scheduling,wongthavarawat2003packet,fattah2002overview,yaacoub2012survey}. For instance, round-robin scheduling is a common approach due to its simplicity inherent fairness. Algorithms such as proportional fair (PF)~\cite{kim2005proportional}, max-SNR~\cite{knopp1995information} and their variations have been designed for maximizing the overall system throughput and/or fairness. For time-sensitive applications such as industrial control and automation, the experiences of individual users/devices are highly dependent on the ability of the network to deliver their packets within a latency bound. Generic delay-aware schedulers such as EDF~\cite{wu2014analysis} and WFQ~\cite{lu1999fair} do not adapt to wireless channel conditions, while channel state information is considered in M-LWDF \cite{andrews2001providing}. However, all such methods are unable to leverage the information on the control system dynamics and thus can make unsuitable radio resource allocation decisions when deployed in time-sensitive wireless control systems.


In the context of wireless control systems, there have been a range of works that incorporates control system information in the networking and communication policies.
%
The mechanisms usually examined are either static or dynamic. Typical examples of the former type are periodically protocols where the wireless devices transmit in a predefined repeating order, e.g., round-robin. Control system stability under such protocols can be analyzed -- see, e.g.,~\cite{Hespanha_survey, Schenato_foundations, Donkers_switched, Branicky_stability}. Periodic sequences leading to stability~\cite{Hristu_shared_feedback}, controllability and observability~\cite{Hristu_communication_control}, or optimizing control objectives~\cite{LeNy_resource_LQR,Meier_measurement_control, Scheduling_control_combinatorics} have been proposed.
%
Dynamic schedulers do not rely on a predefined sequence but decide access to the communication medium dynamically at each step. %, for example by dynamically assigning priorities to the competing tasks.
Initial approaches abstract control performance requirements in the time/frequency domain, e.g., how often a task needs resource access, employing algorithms from real-time scheduling theory~\cite{Branicky_RM, Liu_Real_time_systems}. More recent scheduling approaches often depend on the current control system states, i.e., informally the subsystem with the largest state discrepancy is scheduled to communicate -- see, e.g.,~\cite{Donkers_switched, Walsh_stability, Hristu_Kumar_interrupt_based, Egerstedt_queue, Hirche_Scheduling_Price, Cervin_event_scheduling, mamduhi2014event,shi2011optimal,han2017optimal}.
%
Alternatively scheduling can take into account current wireless channel conditions opportunistically to meet target control system reliability requirements~\cite{GatsisEtal15}. None of these approaches, however, are explicitly designed to achieve strong performance it low-latency scenarios.



In this paper, we develop a control-aware, high reliability, low-latency IEEE 802.11ax WiFi protocol~\cite{bellalta2016ieee} that is designed to reduce the total transmission time at each uplink cycle in the control loop. This is done through the mathematical formulation of the control system design goal in the form of a Lyapunov function that ensures stability of the control system. This formulation naturally induces a bound on the packet delivery rate each control system needs to achieve to meet the control-based goal. Such packet delivery rates depend upon current control and channel states and thus dynamically change over the course of the system life time. This can be viewed as an opportunistic protocol with respect to both the current control states \emph{and} channel conditions. Furthermore, because these control-based success rate requirements may be significantly lower than traditional, high reliability communication demands, the proposed method is better suited to find scheduling configurations that can moreover meet the strict latency requirements imposed by the physical system. This is in contrast to the control-aware approach taken in \cite{GatsisEtal15}, which focuses on low-power and infrequent transmissions rather than the low-latency setting of interest in industrial control.

The paper is organized as follows. We formulate the wireless control system in which state information is communicated to the control over a wireless channel. Due to the potential for random packet drops, this is modeled as a switched dynamical system (Section \ref{sec_problem_formulation}). A Lyapunov function is used to evaluate the stability of the control state, and the uncertainty in this measurement grows the more consecutive packets are lost for a particular system.  We then discuss the scheduling parameters of the IEEE 802.11ax communication model (Section \ref{sec_comm_model}).
%, which allows for centralized scheduling of transmissions through the use of varying bandwidth resource units, time-slotted PPDUs, and date rate selection via MCS selection (Section \ref{sec_comm_model}).
From there, we derive a mathematical formulation of the optimal scheduling problem (Section \ref{sec_optimal}). This can be formulation by minimizing a control cost with an explicitly latency constraint (Section \ref{sec_optimal_a}) or minimizing transmission time with an explicit control performance constraint (Section \ref{sec_optimal_b}).

Using this formulation, we develop the control-aware low latency scheduling (CALLS) method (Section \ref{sec_calls}). The CALLS method uses current control states and channel conditions to derive dynamic packet success rates for each user (Section \ref{sec_psr}). In this way, control systems that are closest to instability will be given priority in the scheduling so that they may close their control loops. The scheduling procedure consists of a random user selection procedure to reduce the number of required PPDUs that incur significant overhead  (Section \ref{sec_rss}), followed by an assignment-method based scheduling of selected users to minimize total transmission time (Section \ref{sec_assignment}). The performance of the CALLS method is analyzed in a series of simulation experiments in which its performance is compared against a control-agnostic procedure (Section \ref{sec_simulation}). We demonstrate in numerous low-latency control systems that the control-aware method can support more users than the alternative and achieve more robust overall performance. 

%The reliability and robustness of wireless communication systems has become a key component in the design and implementation of large scale systems in the Internet-of-Things (IoT). For these systems to operate successfully, it is important that the data or information collected by sensors can be communicated throughout the IoT network. While the most reliable form of data communication is through wired connections, the scale and mobility of modern IoT settings has rendered the cost of installing and maintaining a wired network a significant challenge~\cite{wollschlaeger2017future}. Consequently, the design of wireless control systems that can achieve reliable performance has become of great interest~\cite{varghese2014wireless, li2017review}. The primary challenge is then the inherent trade off that occurs between reliability and latency. Low-latency transmissions are a necessary feature in many wireless IoT systems, particularly those in industrial control~\cite{varghese2014wireless}. It is difficult to maintain high reliability while using higher data rates, however, due to the stochasticity of the wireless channel. It is necessary then to design resource allocation and scheduling protocols for wireless control systems that can both meet reliability \emph{and} latency requirements of the control system.
%
%
%In the wireless communications research and industry, many scheduling techniques have been proposed to provide reliability, or quality of service (QoS), to users across the network in the form of throughput, fairness and/or latency~\cite{cao2001scheduling,wongthavarawat2003packet,fattah2002overview,yaacoub2012survey}. For instance, round-robin scheduling is a common approach due to its simplicity inherent fairness. Algorithms such as proportional fair (PF)~\cite{kim2005proportional}, max-SNR~\cite{knopp1995information} and their variations have been designed for maximizing the overall system throughput and/or fairness. However, these algorithms can perform very poorly with regards to ensuring that all of the admitted users' packet delivery rates and latency targets will be met. For time-sensitive applications such as industrial control and automation, the experiences of individual users/devices are highly dependent on the ability of the network to deliver their packets within a latency bound. If this objective is not met, the high overall system throughput or throughput-fairness means little to the end users. On the other hand, the generic delay-aware schedulers such as EDF~\cite{wu2014analysis} and WFQ~\cite{lu1999fair} do not properly adapt to wireless channel conditions and may make poor radio resource allocation decisions. These algorithms have also been modified to adapt to wireless channel conditions, such as in M-LWDF \cite{andrews2001providing}. However, all such wireless scheduling algorithms are unable to leverage the information on the control system dynamics and thus, perform inefficiently when deployed in time-sensitive wireless control systems.
%
%In the context of wireless control systems, there was been a range or works that incorporates control system information in the networking and communication policies.
%%
%The mechanisms usually examined are either static or dynamic. Typical examples of the first type are periodically protocols where the wireless devices transmit in a predefined repeating order, e.g., round-robin. Control system stability under such protocols can be analyzed -- see, e.g.,~\cite{Hespanha_survey, Schenato_foundations, Donkers_switched, Branicky_stability}. Periodic sequences leading to stability~\cite{Hristu_shared_feedback}, controllability and observability~\cite{Hristu_communication_control}, or optimizing control objectives~\cite{LeNy_resource_LQR,Meier_measurement_control, Scheduling_control_combinatorics} have been proposed.
%%
%The second type of schedulers, the dynamic ones, do not rely on a predefined sequence but decide access to the communication medium dynamically at each step. %, for example by dynamically assigning priorities to the competing tasks.
%Initial approaches abstract control performance requirements in the time/frequency domain, e.g., how often a task needs resource access, employing algorithms from real-time scheduling theory~\cite{Branicky_RM, Liu_Real_time_systems}. More recently scheduling approaches often depend on the current control system states, i.e., informally the subsystem with the largest state discrepancy is scheduled to communicate -- see, e.g.,~\cite{Donkers_switched, Walsh_stability, Hristu_Kumar_interrupt_based, Egerstedt_queue, Hirche_Scheduling_Price, Cervin_event_scheduling, mamduhi2014event,shi2011optimal,han2017optimal}.
%%
%Alternatively scheduling can take into account current wireless channel conditions opportunistically to meet target control system reliability requirements~\cite{GatsisEtal15}. None of these approaches, however, are explicitly designed to minimize communications latency or achieve strong performance with specific low-latency requirements.
%
%
%
%In this paper, we develop a control-aware, high reliability, low-latency IEEE 802.11ax WiFi protocol~\cite{bellalta2016ieee} that is designed to reduce the total transmission time at each uplink cycle in the control loop. This is done through the mathematical formulation of the control system design goal in the form of a Lyapunov function that ensures stability of the control system. This formulation naturally induces a bound on the packet delivery rate each control system needs to achieve to meet the control-based goal. Such packet delivery rates depend upon current control and channel states and thus dynamically change over the course of the system life time. This can be viewed as an opportunistic protocol with respect to both the current control states \emph{and} channel conditions. Furthermore, because these control-based success rate requirements may be significantly lower than traditional, high reliability communication demands, the proposed method is better suited to find scheduling configurations that can moreover meet the strict latency requirements imposed by the physical system.
%
%The paper is organized as follows. We formulate the wireless control system in which state information is communicated to the control over a wireless channel. Due to the potential for random packet drops, this is modeled as a switched dynamical system (Section \ref{sec_problem_formulation}). A Lyapunov function is used to evaluate the stability of the control state, and the uncertainty in this measurement grows the more consecutive packets are lost for a particular system.  We then discuss the scheduling parameters of the IEEE 802.11ax communication model (Section \ref{sec_comm_model}).
%%, which allows for centralized scheduling of transmissions through the use of varying bandwidth resource units, time-slotted PPDUs, and date rate selection via MCS selection (Section \ref{sec_comm_model}). 
%From there, we derive a mathematical formulation of the optimal scheduling problem (Section \ref{sec_optimal}). This can be formulation by minimizing a control cost with an explicitly latency constraint (Section \ref{sec_optimal_a}) or minimizing transmission time with an explicit control performance constraint (Section \ref{sec_optimal_b}).
%
%Using the control-constrained optimal scheduling formulation, we develop the control-aware low latency scheduling (CALLS) method (Section \ref{sec_calls}). The CALLS method uses current control states and channel conditions to derive dynamic packet success rates for each user (Section \ref{sec_psr}). In this way, control systems that are closest to instability will be given priority in the scheduling so that they may close their control loops. The scheduling procedure consists of a random user selection procedure to reduce the number of required PPDUs that incur significant overhead  (Section \ref{sec_rss}), followed by an assignment-method based scheduling of selected users to minimize total transmission time (Section \ref{sec_assignment}). The performance of the CALLS method is analyzed in a series of simulation experiments in which its performance is compared against a control-agnostic procedure (Section \ref{sec_simulation}). We demonstrate in numerous low-latency control systems that the control-aware method can support more users than the alternative and achieve more robust overall performance. 